<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DataFlow Pro Dashboard</title>
    <script>
        window.intercomSettings = {
            api_base: "https://api-iam.intercom.io",
            app_id: "vcz9vfgc",
        };
    </script>

    <script>
        // We pre-filled your app ID in the widget URL: 'https://widget.intercom.io/widget/vcz9vfgc'
        (function () { var w = window; var ic = w.Intercom; if (typeof ic === "function") { ic('reattach_activator'); ic('update', w.intercomSettings); } else { var d = document; var i = function () { i.c(arguments); }; i.q = []; i.c = function (args) { i.q.push(args); }; w.Intercom = i; var l = function () { var s = d.createElement('script'); s.type = 'text/javascript'; s.async = true; s.src = 'https://widget.intercom.io/widget/vcz9vfgc'; var x = d.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s, x); }; if (document.readyState === 'complete') { l(); } else if (w.attachEvent) { w.attachEvent('onload', l); } else { w.addEventListener('load', l, false); } } })();
    </script>

    <!-- FullStory Script -->
    <script>
        window['_fs_host'] = 'fullstory.com';
        window['_fs_script'] = 'edge.fullstory.com/s/fs.js';
        window['_fs_org'] = 'o-23Y708-na1';
        window['_fs_namespace'] = 'FS';
        !function (m, n, e, t, l, o, g, y) {
            var s, f, a = function (h) {
                return !(h in m) || (m.console && m.console.log && m.console.log('FullStory namespace conflict. Please set window["_fs_namespace"].'), !1)
            }(e)
                ; function p(b) {
                    var h, d = []; function j() {
                        h && (d.forEach((function (b) {
                            var d; try { d = b[h[0]] && b[h[0]](h[1]) } catch (h) { return void (b[3] && b[3](h)) }
                            d && d.then ? d.then(b[2], b[3]) : b[2] && b[2](d)
                        })), d.length = 0)
                    } function r(b) { return function (d) { h || (h = [b, d], j()) } } return b(r(0), r(1)), {
                        then: function (b, h) { return p((function (r, i) { d.push([b, h, r, i]), j() })) }
                    }
                } a && (g = m[e] = function () {
                    var b = function (b, d, j, r) {
                        function i(i, c) {
                            h(b, d, j, i, c, r)
                        } r = r || 2; var c, u = /Async$/; return u.test(b) ? (b = b.replace(u, ""), "function" == typeof Promise ? new Promise(i) : p(i)) : h(b, d, j, c, c, r)
                    }
                        ; function h(h, d, j, r, i, c) { return b._api ? b._api(h, d, j, r, i, c) : (b.q && b.q.push([h, d, j, r, i, c]), null) } return b.q = [], b
                }(), y = function (b) {
                    function h(h) {
                        "function" == typeof h[4] && h[4](new Error(b))
                    } var d = g.q; if (d) { for (var j = 0; j < d.length; j++)h(d[j]); d.length = 0, d.push = h }
                }, function () {
                    (o = n.createElement(t)).async = !0, o.crossOrigin = "anonymous", o.src = "https://" + l, o.onerror = function () { y("Error loading " + l) }
                        ; var b = n.getElementsByTagName(t)[0]; b && b.parentNode ? b.parentNode.insertBefore(o, b) : n.head.appendChild(o)
                }(), function () {
                    function b() { }
                    function h(b, h, d) { g(b, h, d, 1) } function d(b, d, j) { h("setProperties", { type: b, properties: d }, j) } function j(b, h) { d("user", b, h) } function r(b, h, d) {
                        j({
                            uid: b
                        }, d), h && j(h, d)
                    } g.identify = r, g.setUserVars = j, g.identifyAccount = b, g.clearUserCookie = b, g.setVars = d, g.event = function (b, d, j) {
                        h("trackEvent", {
                            name: b, properties: d
                        }, j)
                    }, g.anonymize = function () { r(!1) }, g.shutdown = function () { h("shutdown") }, g.restart = function () { h("restart") },
                        g.log = function (b, d) { h("log", { level: b, msg: d }) }, g.consent = function (b) { h("setIdentity", { consent: !arguments.length || b }) }
                }(), s = "fetch",
                    f = "XMLHttpRequest", g._w = {}, g._w[f] = m[f], g._w[s] = m[s], m[s] && (m[s] = function () { return g._w[s].apply(this, arguments) }), g._v = "2.0.0")
        }(window, document, window._fs_namespace, "script", window._fs_script);
    </script>

    <!-- FullStory User Identification will happen after form submission -->

    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f7fa;
        }

        .dashboard {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .metric-card {
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .metric-title {
            color: #666;
            font-size: 14px;
            margin-bottom: 8px;
        }

        .metric-value {
            font-size: 24px;
            font-weight: bold;
            color: #2d3748;
        }

        .chart-container {
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .status {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }

        .status-healthy {
            background: #c6f6d5;
            color: #2f855a;
        }

        .status-warning {
            background: #feebc8;
            color: #c05621;
        }

        .action-button {
            background: #4299e1;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.2s;
            margin-top: 20px;
        }

        .action-button:hover {
            background: #3182ce;
        }

        .action-button:active {
            background: #2c5282;
        }

        .form-container {
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #2d3748;
        }

        .form-input {
            width: 100%;
            padding: 10px;
            border: 1px solid #cbd5e0;
            border-radius: 4px;
            font-size: 14px;
            box-sizing: border-box;
        }

        .form-input:focus {
            outline: none;
            border-color: #4299e1;
        }

        .submit-button {
            background: #48bb78;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.2s;
        }

        .submit-button:hover {
            background: #38a169;
        }

        .submit-button:disabled {
            background: #a0aec0;
            cursor: not-allowed;
        }

        .success-message {
            color: #2f855a;
            margin-top: 10px;
            font-weight: 500;
        }
    </style>
</head>

<body>
    <div class="dashboard">
        <div class="header">
            <h1>DataFlow Pro Dashboard</h1>
            <p>System Status: <span class="status status-healthy">All Systems Operational</span></p>
        </div>

        <!-- User Identification Form -->
        <div class="form-container" id="identifyForm">
            <h2>Identify Yourself</h2>
            <p>Enter your email to be identified in FullStory:</p>
            <form id="userForm">
                <div class="form-group">
                    <label class="form-label" for="userEmail">Email Address</label>
                    <input type="email" id="userEmail" class="form-input" placeholder="you@example.com" required>
                </div>
                <button type="submit" class="submit-button">Submit</button>
                <p id="formSuccess" class="success-message" style="display: none;">✓ Successfully identified in FullStory!</p>
            </form>
        </div>

        <div class="metrics">
            <div class="metric-card">
                <div class="metric-title">Active Pipelines</div>
                <div class="metric-value">1,247</div>
            </div>
            <div class="metric-card">
                <div class="metric-title">Data Processed Today</div>
                <div class="metric-value">8.7 TB</div>
            </div>
            <div class="metric-card">
                <div class="metric-title">Success Rate</div>
                <div class="metric-value">99.98%</div>
            </div>
            <div class="metric-card">
                <div class="metric-title">Active Users</div>
                <div class="metric-value">12,892</div>
            </div>
        </div>

        <div class="chart-container">
            <h2>Recent Alerts</h2>
            <table style="width: 100%; border-collapse: collapse;">
                <tr style="text-align: left; border-bottom: 1px solid #e2e8f0;">
                    <th style="padding: 12px;">Time</th>
                    <th style="padding: 12px;">Pipeline</th>
                    <th style="padding: 12px;">Status</th>
                </tr>
                <tr>
                    <td style="padding: 12px;">13:45</td>
                    <td style="padding: 12px;">prod-etl-customer-data</td>
                    <td style="padding: 12px;"><span class="status status-healthy">Resolved</span></td>
                </tr>
                <tr>
                    <td style="padding: 12px;">12:30</td>
                    <td style="padding: 12px;">staging-analytics-pipeline</td>
                    <td style="padding: 12px;"><span class="status status-warning">Investigating</span></td>
                </tr>
                <tr>
                    <td style="padding: 12px;">11:15</td>
                    <td style="padding: 12px;">dev-test-pipeline</td>
                    <td style="padding: 12px;"><span class="status status-healthy">Resolved</span></td>
                </tr>
            </table>
        </div>

        <div class="chart-container">
            <h2>Actions</h2>
            <p>Click the button below to trigger a FullStory event:</p>
            <button id="exportDataBtn" class="action-button">Export Data Report</button>
            <p id="statusMessage" style="margin-top: 10px; color: #2f855a; display: none;">✓ Event logged to FullStory!
            </p>
        </div>
    </div>

    <script>
        // Generate a random UUID v4
        function generateUUID() {
            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
                const r = Math.random() * 16 | 0;
                const v = c === 'x' ? r : (r & 0x3 | 0x8);
                return v.toString(16);
            });
        }

        // Handle user identification form submission
        document.getElementById('userForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const email = document.getElementById('userEmail').value;
            const userId = generateUUID();
            
            // Identify user in FullStory
            if (window.FS) {
                FS.identify(userId, {
                    email: email,
                    displayName: email.split('@')[0],
                    identifiedAt: new Date().toISOString()
                });
                console.log('FullStory user identified:', userId, email);
            }
            
            // Show success message
            document.getElementById('formSuccess').style.display = 'block';
            
            // Optionally hide the form after submission
            setTimeout(() => {
                document.getElementById('identifyForm').style.display = 'none';
            }, 2000);
        });

        // FullStory Event Tracking
        document.getElementById('exportDataBtn').addEventListener('click', function () {
            // Log event to FullStory
            if (window.FS) {
                FS.event('Export Data Clicked', {
                    buttonLocation: 'dashboard',
                    reportType: 'data-export',
                    timestamp: new Date().toISOString()
                });
                console.log('FullStory event logged: Export Data Clicked');
            }

            // Show confirmation message
            const statusMsg = document.getElementById('statusMessage');
            statusMsg.style.display = 'block';
            setTimeout(() => {
                statusMsg.style.display = 'none';
            }, 3000);
        });
    </script>
</body>

</html>